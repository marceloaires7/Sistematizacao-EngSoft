{% extends "hotel/base.html" %}

{% block title %}Minhas Reservas{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Minhas Reservas</h1>
    <a href="{% url 'hotel:buscar_quarto' %}" class="btn btn-primary">Fazer uma Nova Reserva</a>
  </div>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
  {% endif %}

  <div class="list-group">
    {% for reserva in reservas %}
      <div class="list-group-item">
        <div class="d-flex w-100 justify-content-between">
          <h5 class="mb-1">{{ reserva.quarto }}</h5>
          <span class="badge 
              {% if reserva.status == 'CONFIRMADO' %}bg-success
              {% elif reserva.status == 'CANCELADO' %}bg-danger
              {% else %}bg-secondary{% endif %}">
              {{ reserva.get_status_display }}
          </span>
        </div>
        <p class="mb-1">
          <strong>Período:</strong> {{ reserva.data_checkin|date:"d/m/Y" }} a {{ reserva.data_checkout|date:"d/m/Y" }}
        </p>
        
        {% if reserva.pode_cancelar %}
          <form method="post" action="{% url 'hotel:cancelar_reserva' reserva.pk %}" class="mt-2" onsubmit="return confirm('Tem certeza que deseja cancelar esta reserva?');">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger">Cancelar Reserva</button>
          </form>
        {% endif %}
      </div>
    {% empty %}
      <div class="alert alert-info">Você ainda não possui nenhuma reserva.</div>
    {% endfor %}
  </div>
{% endblock %}
